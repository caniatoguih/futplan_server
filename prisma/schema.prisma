generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model locations {
  location_id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  location_name         String    @db.VarChar(150)
  max_capacity          Int
  location_zip_code     String?   @db.VarChar(15)
  location_street       String    @db.VarChar(255)
  location_number       String?   @db.VarChar(10)
  location_complement   String?   @db.VarChar(100)
  location_neighborhood String?   @db.VarChar(100)
  location_city         String    @db.VarChar(100)
  location_state        String    @db.Char(2)
  location_country      String?   @default("Brazil") @db.VarChar(50)
  created_at            DateTime? @default(now()) @db.Timestamptz(6)
  updated_at            DateTime? @default(now()) @db.Timestamptz(6)
  matches               matches[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model match_events {
  event_id                                   String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  match_id                                   String    @db.Uuid
  player_id                                  String    @db.Uuid
  assist_player_id                           String?   @db.Uuid
  event_type                                 String    @db.VarChar(20)
  match_minute                               Int?
  event_details                              String?
  created_at                                 DateTime? @default(now()) @db.Timestamptz(6)
  users_match_events_assist_player_idTousers users?    @relation("match_events_assist_player_idTousers", fields: [assist_player_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
  matches                                    matches   @relation(fields: [match_id], references: [match_id], onDelete: Cascade, onUpdate: NoAction)
  users_match_events_player_idTousers        users     @relation("match_events_player_idTousers", fields: [player_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model match_roster {
  match_id        String    @db.Uuid
  user_id         String    @db.Uuid
  team_assignment String?   @db.VarChar(20)
  status          String?   @default("pending") @db.VarChar(20)
  joined_at       DateTime? @default(now()) @db.Timestamptz(6)
  matches         matches   @relation(fields: [match_id], references: [match_id], onDelete: Cascade, onUpdate: NoAction)
  users           users     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([match_id, user_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model matches {
  match_id                          String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  location_id                       String         @db.Uuid
  home_team_id                      String?        @db.Uuid
  away_team_id                      String?        @db.Uuid
  home_team_score                   Int?           @default(0)
  away_team_score                   Int?           @default(0)
  match_datetime                    DateTime       @db.Timestamptz(6)
  match_status                      String?        @default("scheduled") @db.VarChar(20)
  created_at                        DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at                        DateTime?      @default(now()) @db.Timestamptz(6)
  created_by                        String?        @db.Uuid
  match_events                      match_events[]
  match_roster                      match_roster[]
  teams_matches_away_team_idToteams teams?         @relation("matches_away_team_idToteams", fields: [away_team_id], references: [team_id], onDelete: NoAction, onUpdate: NoAction)
  users                             users?         @relation(fields: [created_by], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
  teams_matches_home_team_idToteams teams?         @relation("matches_home_team_idToteams", fields: [home_team_id], references: [team_id], onDelete: NoAction, onUpdate: NoAction)
  locations                         locations      @relation(fields: [location_id], references: [location_id], onDelete: NoAction, onUpdate: NoAction)
}

model team_members {
  team_id       String    @db.Uuid
  user_id       String    @db.Uuid
  jersey_number Int?
  joined_at     DateTime? @default(now()) @db.Timestamptz(6)
  teams         teams     @relation(fields: [team_id], references: [team_id], onDelete: Cascade, onUpdate: NoAction)
  users         users     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([team_id, user_id])
}

model teams {
  team_id                             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  team_name                           String         @db.VarChar(100)
  team_main_color_hex                 String         @db.Char(7)
  owner_id                            String?        @db.Uuid
  created_at                          DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at                          DateTime?      @default(now()) @db.Timestamptz(6)
  matches_matches_away_team_idToteams matches[]      @relation("matches_away_team_idToteams")
  matches_matches_home_team_idToteams matches[]      @relation("matches_home_team_idToteams")
  team_members                        team_members[]
  users                               users?         @relation(fields: [owner_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
}

model users {
  user_id                                           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_name                                         String         @db.VarChar(100)
  user_email                                        String         @unique @db.VarChar(255)
  password_hash                                     String
  created_at                                        DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at                                        DateTime?      @default(now()) @db.Timestamptz(6)
  is_active                                         Boolean?       @default(true)
  user_phone                                        String?        @db.VarChar(20)
  user_address_zip_code                             String?        @db.VarChar(15)
  user_address_street                               String?        @db.VarChar(255)
  user_address_number                               String?        @db.VarChar(10)
  user_address_complement                           String?        @db.VarChar(100)
  user_address_neighborhood                         String?        @db.VarChar(100)
  user_address_city                                 String?        @db.VarChar(100)
  user_address_state                                String?        @db.Char(2)
  user_address_country                              String?        @default("Brazil") @db.VarChar(50)
  role                                              Role           @default(PLAYER)
  match_events_match_events_assist_player_idTousers match_events[] @relation("match_events_assist_player_idTousers")
  match_events_match_events_player_idTousers        match_events[] @relation("match_events_player_idTousers")
  match_roster                                      match_roster[]
  matches                                           matches[]
  team_members                                      team_members[]
  teams                                             teams[]
}

enum Role {
  ADMIN
  MANAGER
  PLAYER
}
